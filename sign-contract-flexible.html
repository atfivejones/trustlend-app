<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Contract - TrustLend</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .signature-canvas {
            border: 2px dashed #d1d5db;
            border-radius: 8px;
            cursor: crosshair;
        }
        .signature-canvas.active {
            border-color: #3b82f6;
            border-style: solid;
        }
        .hero-gradient {
            background: linear-gradient(135deg, #1e3a8a 0%, #3730a3 50%, #7c3aed 100%);
        }
        .step-active {
            background: linear-gradient(135deg, #3b82f6, #6366f1);
            color: white;
        }
        .step-completed {
            background-color: #22c55e;
            color: white;
        }
        .step-inactive {
            background-color: #e5e7eb;
            color: #6b7280;
        }
        
        /* Blockchain Pulse Animation */
        @keyframes blockchainPulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }
        
        .blockchain-indicator {
            animation: blockchainPulse 2s ease-in-out infinite;
        }
        
        .dropdown-menu {
            transform: translateY(-10px);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .dropdown-menu.show {
            transform: translateY(0);
            opacity: 1;
            visibility: visible;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Universal Navigation Header -->
    <header class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <!-- Logo -->
                <a href="index.html" class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
                        <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <span class="text-xl font-bold text-gray-900">TrustLend</span>
                </a>

                <!-- Desktop Navigation -->
                <nav class="hidden md:flex items-center space-x-8">
                    <a href="dashboard.html" class="text-gray-700 hover:text-blue-600 font-medium">Dashboard</a>
                    
                    <!-- Contracts Dropdown -->
                    <div class="relative group">
                        <button class="text-blue-600 font-medium flex items-center" onclick="toggleDropdown('contracts-dropdown')">
                            Contracts
                            <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                        <div id="contracts-dropdown" class="dropdown-menu absolute left-0 mt-2 w-56 bg-white rounded-md shadow-lg border border-gray-200">
                            <a href="create-note-advanced.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">Create Contract</a>
                            <a href="contracts.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">View All Contracts</a>
                            <a href="demand-letter.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">Send Demand Letter</a>
                            <a href="sign-contract-flexible.html" class="block px-4 py-2 text-blue-600 hover:bg-gray-100 font-medium">Sign Contract</a>
                        </div>
                    </div>
                    
                    <!-- Templates Dropdown -->
                    <div class="relative group">
                        <button class="text-gray-700 hover:text-blue-600 font-medium flex items-center" onclick="toggleDropdown('templates-dropdown')">
                            Templates
                            <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                        <div id="templates-dropdown" class="dropdown-menu absolute left-0 mt-2 w-48 bg-white rounded-md shadow-lg border border-gray-200">
                            <a href="templates.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">Promissory Notes</a>
                            <a href="templates.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">Loan Agreements</a>
                            <a href="templates.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">Payment Plans</a>
                        </div>
                    </div>
                    
                    <a href="verification.html" class="text-gray-700 hover:text-blue-600 font-medium">Verification</a>
                    <a href="tips.html" class="text-gray-700 hover:text-blue-600 font-medium">Tips</a>
                </nav>

                <!-- Right Side Items -->
                <div class="flex items-center space-x-4">
                    <!-- Blockchain Status Indicator -->
                    <div class="hidden sm:flex items-center space-x-2 bg-blue-50 px-3 py-1 rounded-full">
                        <div class="w-2 h-2 bg-green-500 rounded-full blockchain-indicator"></div>
                        <span class="text-xs text-blue-700 font-medium">Blockchain Verified</span>
                    </div>
                    
                    <!-- Account Dropdown -->
                    <div class="relative">
                        <button onclick="toggleDropdown('account-dropdown')" class="flex items-center space-x-2 text-gray-700 hover:text-gray-900">
                            <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                <span class="text-sm font-medium text-blue-600">D</span>
                            </div>
                            <span class="hidden sm:block text-sm font-medium">demo@trustlend.app</span>
                        </button>
                        
                        <div id="account-dropdown" class="dropdown-menu absolute right-0 mt-2 w-72 bg-white rounded-md shadow-lg border border-gray-200">
                            <!-- Account Info -->
                            <div class="px-4 py-3 border-b border-gray-100">
                                <div class="text-sm text-gray-900 font-medium">demo@trustlend.app</div>
                                <div class="text-xs text-blue-600 flex items-center mt-1">
                                    <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                    </svg>
                                    Blockchain Verified â€¢ Essential Plan
                                </div>
                            </div>
                            
                            <!-- Account Menu Items -->
                            <a href="profile.html" class="flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100">
                                <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                                </svg>
                                Profile Settings
                            </a>
                            
                            <a href="billing.html" class="flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100">
                                <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/>
                                </svg>
                                Billing & Plans
                            </a>
                            
                            <a href="audit-trail.html" class="flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100">
                                <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                </svg>
                                Audit Trail & Verification
                            </a>
                            
                            <div class="border-t border-gray-100 my-1"></div>
                            
                            <a href="#" class="flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100">
                                <svg class="w-4 h-4 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                                </svg>
                                Sign Out
                            </a>
                        </div>
                    </div>

                    <!-- Mobile menu button -->
                    <button onclick="toggleMobileMenu()" class="md:hidden p-2 rounded-md text-gray-700 hover:text-gray-900 hover:bg-gray-100">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div id="mobile-menu" class="md:hidden hidden border-t border-gray-200">
            <div class="px-2 pt-2 pb-3 space-y-1 bg-white">
                <a href="dashboard.html" class="block px-3 py-2 text-gray-700 hover:bg-gray-100 rounded-md">Dashboard</a>
                <a href="create-note-advanced.html" class="block px-3 py-2 text-gray-700 hover:bg-gray-100 rounded-md">Create Contract</a>
                <a href="contracts.html" class="block px-3 py-2 text-gray-700 hover:bg-gray-100 rounded-md">View Contracts</a>
                <a href="templates.html" class="block px-3 py-2 text-gray-700 hover:bg-gray-100 rounded-md">Templates</a>
                <a href="verification.html" class="block px-3 py-2 text-gray-700 hover:bg-gray-100 rounded-md">Verification</a>
                <a href="tips.html" class="block px-3 py-2 text-gray-700 hover:bg-gray-100 rounded-md">Tips</a>
                <a href="profile.html" class="block px-3 py-2 text-gray-700 hover:bg-gray-100 rounded-md">Profile</a>
                <a href="billing.html" class="block px-3 py-2 text-gray-700 hover:bg-gray-100 rounded-md">Billing</a>
            </div>
        </div>
    </header>

    <!-- Contract Progress Banner -->
    <div class="bg-blue-50 border-b border-blue-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="flex items-center space-x-2">
                        <svg class="w-5 h-5 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <span class="text-sm font-medium text-blue-900">Contract: TL-1234567890</span>
                    </div>
                    <div class="hidden sm:flex items-center space-x-2">
                        <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                        <span class="text-xs text-blue-700">Blockchain Secured</span>
                    </div>
                </div>
                <div class="text-sm text-blue-700">
                    Step 4 of 4: <span class="font-medium">Digital Signing</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Signing Method Selection -->
    <div id="signing-method-selection" class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-900 mb-4">How would you like to sign?</h1>
            <p class="text-gray-600">Choose the signing method that works best for your situation</p>
            
            <!-- Blockchain Security Badge -->
            <div class="inline-flex items-center space-x-2 bg-green-50 border border-green-200 rounded-full px-4 py-2 mt-4">
                <svg class="w-4 h-4 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"/>
                </svg>
                <span class="text-sm font-medium text-green-800">Blockchain-Secured Digital Signatures</span>
            </div>
        </div>

        <!-- Contract Summary -->
        <div class="bg-white rounded-xl border border-gray-200 p-6 mb-8">
            <h2 class="text-xl font-bold text-gray-900 mb-4">Contract Summary</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                <div>
                    <span class="text-gray-600">Principal Amount:</span>
                    <div class="font-bold text-lg text-gray-900">$5,000.00</div>
                </div>
                <div>
                    <span class="text-gray-600">Service Fee:</span>
                    <div class="font-bold text-lg text-gray-900">$50.00</div>
                </div>
                <div>
                    <span class="text-gray-600">Total Due:</span>
                    <div class="font-bold text-lg text-blue-600">$5,050.00</div>
                </div>
                <div>
                    <span class="text-gray-600">Due Date:</span>
                    <div class="font-bold text-lg text-gray-900">July 25, 2025</div>
                </div>
            </div>
            <div class="mt-4 pt-4 border-t border-gray-200">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <span class="text-gray-600">Borrower:</span>
                        <div class="font-semibold text-gray-900">Sarah Johnson</div>
                    </div>
                    <div>
                        <span class="text-gray-600">Lender:</span>
                        <div class="font-semibold text-gray-900">John Doe</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Signing Options -->
        <div class="grid md:grid-cols-2 gap-6">
            <!-- In-Person Signing -->
            <div class="bg-white rounded-xl border border-gray-200 p-6 hover:shadow-lg transition-shadow cursor-pointer" onclick="selectSigningMethod('in-person')">
                <div class="text-center">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 mb-2">Sign In Person</h3>
                    <p class="text-gray-600 mb-4">Both parties sign on this device right now</p>
                    <div class="space-y-2 text-sm text-gray-600">
                        <div class="flex items-center justify-center gap-2">
                            <svg class="w-4 h-4 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                            </svg>
                            <span>Fastest method</span>
                        </div>
                        <div class="flex items-center justify-center gap-2">
                            <svg class="w-4 h-4 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                            </svg>
                            <span>No waiting for emails/texts</span>
                        </div>
                        <div class="flex items-center justify-center gap-2">
                            <svg class="w-4 h-4 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                            </svg>
                            <span>Complete in 2-3 minutes</span>
                        </div>
                    </div>
                    <button class="w-full mt-6 bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 transition-all">
                        Start In-Person Signing
                    </button>
                </div>
            </div>

            <!-- Remote Signing -->
            <div class="bg-white rounded-xl border border-gray-200 p-6 hover:shadow-lg transition-shadow cursor-pointer" onclick="selectSigningMethod('remote')">
                <div class="text-center">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900 mb-2">Send for Remote Signing</h3>
                    <p class="text-gray-600 mb-4">Send invitation to borrower via email/SMS</p>
                    <div class="space-y-2 text-sm text-gray-600">
                        <div class="flex items-center justify-center gap-2">
                            <svg class="w-4 h-4 text-blue-500" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                            </svg>
                            <span>More convenient for borrower</span>
                        </div>
                        <div class="flex items-center justify-center gap-2">
                            <svg class="w-4 h-4 text-blue-500" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                            </svg>
                            <span>Digital verification included</span>
                        </div>
                        <div class="flex items-center justify-center gap-2">
                            <svg class="w-4 h-4 text-blue-500" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                            </svg>
                            <span>Automatic reminders</span>
                        </div>
                    </div>
                    <button class="w-full mt-6 bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition-all">
                        Send for Remote Signing
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- In-Person Signing Flow (Hidden by default) -->
    <div id="in-person-signing-flow" class="hidden">
        <!-- Step Progress -->
        <div class="bg-white border-b border-gray-200">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                <div class="flex items-center justify-center space-x-4">
                    <div class="flex items-center space-x-2 step-completed">
                        <div class="w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold">1</div>
                        <span class="text-sm font-medium">Lender Signs</span>
                    </div>
                    <div class="w-8 h-0.5 bg-gray-300"></div>
                    <div class="flex items-center space-x-2 step-active">
                        <div class="w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold">2</div>
                        <span class="text-sm font-medium">Borrower Signs</span>
                    </div>
                    <div class="w-8 h-0.5 bg-gray-300"></div>
                    <div class="flex items-center space-x-2 step-inactive">
                        <div class="w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold">3</div>
                        <span class="text-sm font-medium">Complete</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Signature Collection -->
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="bg-white rounded-xl border border-gray-200 p-8">
                <div class="text-center mb-8">
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">Borrower Signature Required</h2>
                    <p class="text-gray-600">Please sign below to complete the contract</p>
                </div>

                <!-- Signature Canvas -->
                <div class="mb-8">
                    <label class="block text-sm font-medium text-gray-700 mb-4">Digital Signature</label>
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 bg-gray-50">
                        <canvas id="signature-canvas" width="600" height="200" class="signature-canvas w-full" style="max-width: 100%; height: auto;"></canvas>
                    </div>
                    <div class="flex justify-between items-center mt-4">
                        <button onclick="clearSignature()" class="text-gray-600 hover:text-gray-900 text-sm">Clear Signature</button>
                        <div class="text-xs text-gray-500">Sign above using your mouse, finger, or stylus</div>
                    </div>
                </div>

                <!-- Verification -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Identity Verification</h3>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                            <input type="text" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Sarah Johnson" value="Sarah Johnson">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                            <input type="email" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="sarah@example.com" value="sarah@example.com">
                        </div>
                    </div>
                </div>

                <!-- Final Agreement -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-8">
                    <div class="flex items-start space-x-3">
                        <input type="checkbox" id="final-agreement" class="mt-1">
                        <label for="final-agreement" class="text-sm text-blue-800">
                            I confirm that I have read and understood the terms of this promissory note, and I agree to be legally bound by its terms. I understand that this signature will be recorded on the blockchain for verification purposes.
                        </label>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex space-x-4">
                    <button onclick="goBackToMethods()" class="flex-1 border border-gray-300 text-gray-700 py-3 rounded-lg hover:bg-gray-50 transition-colors">
                        Back to Signing Methods
                    </button>
                    <button onclick="finalizeContract()" class="flex-1 bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition-colors" disabled id="finalize-btn">
                        Complete Contract
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Remote Signing Setup (Hidden by default) -->
    <div id="remote-signing-setup" class="hidden">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="bg-white rounded-xl border border-gray-200 p-8">
                <div class="text-center mb-8">
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">Send Signing Invitation</h2>
                    <p class="text-gray-600">Enter the borrower's contact information to send the signing invitation</p>
                </div>

                <!-- Contact Information -->
                <div class="space-y-6 mb-8">
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Borrower's Full Name</label>
                            <input type="text" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Sarah Johnson" value="Sarah Johnson">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                            <input type="email" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="sarah@example.com" value="sarah@example.com">
                        </div>
                    </div>
                    
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Phone Number (Optional)</label>
                            <input type="tel" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="+1 (555) 123-4567">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Preferred Contact Method</label>
                            <select class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                <option>Email Only</option>
                                <option>SMS Only</option>
                                <option>Both Email & SMS</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Message Customization -->
                <div class="mb-8">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Custom Message (Optional)</label>
                    <textarea class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" rows="3" placeholder="Hi Sarah, please review and sign the promissory note we discussed. Thanks!"></textarea>
                </div>

                <!-- Blockchain Notice -->
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-8">
                    <div class="flex items-start space-x-3">
                        <svg class="w-5 h-5 text-green-600 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"/>
                        </svg>
                        <div>
                            <h5 class="font-medium text-green-900 mb-1">Blockchain Security</h5>
                            <p class="text-sm text-green-800">The borrower will receive a secure link that includes identity verification and blockchain recording of their signature.</p>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex space-x-4">
                    <button onclick="goBackToMethods()" class="flex-1 border border-gray-300 text-gray-700 py-3 rounded-lg hover:bg-gray-50 transition-colors">
                        Back to Signing Methods
                    </button>
                    <button onclick="sendSigningInvitation()" class="flex-1 bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition-colors">
                        Send Signing Invitation
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dropdown functionality
        function toggleDropdown(dropdownId) {
            const dropdown = document.getElementById(dropdownId);
            dropdown.classList.toggle('show');
            
            // Close other dropdowns
            document.querySelectorAll('.dropdown-menu').forEach(menu => {
                if (menu.id !== dropdownId) {
                    menu.classList.remove('show');
                }
            });
        }

        // Mobile menu toggle
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('hidden');
        }

        // Close dropdowns when clicking outside
        document.addEventListener('click', function(event) {
            const dropdowns = document.querySelectorAll('.dropdown-menu');
            dropdowns.forEach(dropdown => {
                if (!dropdown.closest('.relative').contains(event.target)) {
                    dropdown.classList.remove('show');
                }
            });
        });

        // Signing method selection
        function selectSigningMethod(method) {
            if (method === 'in-person') {
                document.getElementById('signing-method-selection').classList.add('hidden');
                document.getElementById('in-person-signing-flow').classList.remove('hidden');
                document.getElementById('remote-signing-setup').classList.add('hidden');
            } else if (method === 'remote') {
                document.getElementById('signing-method-selection').classList.add('hidden');
                document.getElementById('in-person-signing-flow').classList.add('hidden');
                document.getElementById('remote-signing-setup').classList.remove('hidden');
            }
        }

        function goBackToMethods() {
            document.getElementById('signing-method-selection').classList.remove('hidden');
            document.getElementById('in-person-signing-flow').classList.add('hidden');
            document.getElementById('remote-signing-setup').classList.add('hidden');
        }

        // Signature canvas functionality
        let isDrawing = false;
        let canvas, ctx;

        document.addEventListener('DOMContentLoaded', function() {
            canvas = document.getElementById('signature-canvas');
            if (canvas) {
                ctx = canvas.getContext('2d');
                
                // Set canvas size
                canvas.width = 600;
                canvas.height = 200;
                
                // Set drawing styles
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 2;
                ctx.lineCap = 'round';
                
                // Mouse events
                canvas.addEventListener('mousedown', startDrawing);
                canvas.addEventListener('mousemove', draw);
                canvas.addEventListener('mouseup', stopDrawing);
                canvas.addEventListener('mouseout', stopDrawing);
                
                // Touch events
                canvas.addEventListener('touchstart', handleTouch);
                canvas.addEventListener('touchmove', handleTouch);
                canvas.addEventListener('touchend', stopDrawing);
            }
        });

        function startDrawing(e) {
            isDrawing = true;
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            ctx.beginPath();
            ctx.moveTo(x, y);
            canvas.classList.add('active');
        }

        function draw(e) {
            if (!isDrawing) return;
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            ctx.lineTo(x, y);
            ctx.stroke();
        }

        function stopDrawing() {
            isDrawing = false;
            canvas.classList.remove('active');
            checkFormCompletion();
        }

        function handleTouch(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent(e.type === 'touchstart' ? 'mousedown' : 
                                            e.type === 'touchmove' ? 'mousemove' : 'mouseup', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            canvas.dispatchEvent(mouseEvent);
        }

        function clearSignature() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            checkFormCompletion();
        }

        function checkFormCompletion() {
            const checkbox = document.getElementById('final-agreement');
            const finalizeBtn = document.getElementById('finalize-btn');
            
            // Check if signature exists (canvas has content)
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const hasSignature = imageData.data.some((channel, index) => index % 4 !== 3 && channel !== 0);
            
            finalizeBtn.disabled = !(hasSignature && checkbox.checked);
        }

        // Final agreement checkbox
        document.addEventListener('change', function(e) {
            if (e.target.id === 'final-agreement') {
                checkFormCompletion();
            }
        });

        function finalizeContract() {
            // Record signature on blockchain (simulated)
            const contractData = {
                contractId: 'TL-1234567890',
                signatureTimestamp: new Date().toISOString(),
                signatureHash: 'sha256_hash_of_signature_' + Date.now(),
                borrowerVerified: true,
                lenderVerified: true
            };
            
            // Save to localStorage for demonstration
            localStorage.setItem('completedContract', JSON.stringify(contractData));
            
            alert('Contract completed and recorded on blockchain!');
            window.location.href = 'contracts.html';
        }

        function sendSigningInvitation() {
            const invitationData = {
                contractId: 'TL-1234567890',
                borrowerEmail: document.querySelector('input[type="email"]').value,
                sentTimestamp: new Date().toISOString(),
                status: 'pending'
            };
            
            // Save to localStorage for demonstration
            localStorage.setItem('pendingInvitation', JSON.stringify(invitationData));
            
            alert('Signing invitation sent! The borrower will receive an email with a secure signing link.');
            window.location.href = 'contracts.html';
        }
    </script>
</body>
</html>
